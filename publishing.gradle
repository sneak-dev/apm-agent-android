apply plugin: 'maven-publish'

afterEvaluate {
    publishing {
        publications {
            if (!project.plugins.hasPlugin("java-gradle-plugin")) {
                maven(MavenPublication) {
                    if (isAndroidProject()) {
                        from components.debug
                    } else {
                        from components.java
                    }
                }
            }
        }
    }
}

private boolean isAndroidProject() {
    project.extensions.findByName("android") != null
}